<h1> All Users </h1>


<%= form_with do |form| %>
<%= form.label :"Role Name" %>
<%= form.collection_select :id, Role.all, :id, :name, prompt: true , id: "ctg"%>
<%end%>


<table class="table table-striped mt-1">
  <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Cell</th>
      <th>Role</th>
      <th>Email Confirmed</th>
    </tr>
  </thead>
  <tbody id="abc">    
      <% @users.each do |user| %>
        <tr>
          <td>  <%= user.fname %></td>
          <td>  <%= user.lname %></td>
          <td>  <%=user.email %></td>
          <td>  <%=user.cell %></td>
          <td>  <%=user.role.name %></td>
          <td>  <%=user.confirmed?%></td>
          <td><%= link_to "Delete", admins_user_path(user),  data: {turbo_method: :delete, turbo_confirm: 'Are you sure?'} , class: 'btn btn-sm btn-danger'%>  </td>
        </tr>
      <%end%>
    
  </tbody>
</table>

<script>

$(document).ready(function()

{
   $('select').on("change",function(e){
    
       var role=e.target.value;
    //    console.log(data_book)
       $.ajax({
        type:"GET",
        url: "/toggleusers",
        data: {data: role},
       

        success: function(data){
            
            console.log("ok"+role);
},
    error: function(XMLHttpRequest, textStatus, errorThrown){
     console.log(XMLHttpRequest.responseText);
    }
    });

   });
}
);


</script>
