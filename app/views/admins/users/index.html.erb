  <%= form_with do |form| %>
<div class="flex justify-center items-center mt-[6rem] text-center ">

    <div class="px-2 sm:w-1/3">
        <%= form.label :"Filter By Role", class:"text-xs sm:text-base" %>
        <%= form.collection_select :role_id, Role.all, :id, :capitalize_name,{prompt:"Please Select"},class:"users_filters bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",id:"role_select"%>
    </div>
    <div class="px-2 sm:w-1/3">
        <%= form.label :"Filter By Technology",class:"text-xs sm:text-base" %>
        <%= form.collection_select :technology_id, Technology.all, :id, :capitalize_name,{prompt:"Please Select"},class:"users_filters bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",id:"technology_select"%>
    </div>
  <% end %>
</div>
<%# ------------ above is filters area %>
<div class="m-10">
  <div class="flex justify-between ">
    <div class="text-center">
      <h1 class="text-2xl">Users</h1>
    </div>
    <div class="">
      <%= link_to 'Create User',  new_admins_user_path, data:{turbo_frame: "modal"}, class:"text-base bg-green-500 p-3  rounded-md text-white"  %>
    </div>
  </div>
  <div class="mt-6 overflow-x-auto relative shadow-md sm:rounded-lg">
    <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
      <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
        <tr>
          <th scope="col" class="py-3 px-6">
            Sr.no
          </th>
          <th scope="col" class="py-3 px-6">
            Email
          </th>
          <th scope="col" class="py-3 px-6">
            Role
          </th>
          <th scope="col" class="py-3 px-6">
            Email Confirmed
          </th>
          <th scope="col" class="py-3 px-6">
            Technology
          </th>
          <th scope="col" class="py-3 px-6">
          </th>
        </tr>
      </thead>
      <tbody id="abc">
      <% @users.each.with_index(1) do |user,index| %>
        <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
          <th scope="row" class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">
            <%= index%>
          </th>
          <th scope="row" class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">
            <%=user.email %>
          </th>
          <td class="py-4 px-6">
            <%=user.role.name.titleize %>
          </td>
          <td class="py-4 px-6">
            <%=user.confirmed?%>
          </td>
          <td class="py-4 px-6">
            <%=user.technology.name%>
          </td>
          <td class="py-4 px-6">
            <%= link_to "Delete", admins_user_path(user),  data: {turbo_method: :delete, turbo_confirm: 'Are you sure?'},class:"bg-red-500 p-3 rounded-lg text-white"%>
          </td>
        </tr>
        <%end%>
      </tbody>
    </table>
  </div>
</div>
<script>
$(document).ready(function(){
  $('.users_filters').on("change",function(e){
    // initialize variables
    var role_id = $('#role_select').val();
    var technology_id = $('#technology_select').val();
    url = "/toggleusers";
    data = {role_id: role_id, technology_id: technology_id};
        
    // Ajax call
    $.ajax({
      type:"GET",
      url: url,
      data: data,
      success: function(data){
        console.log("ok"+data);
      },
      error: function(XMLHttpRequest, textStatus, errorThrown){
        console.log(XMLHttpRequest.responseText);
      }
    });//end ajax
  });// end user filters
});// end ready function
</script>
